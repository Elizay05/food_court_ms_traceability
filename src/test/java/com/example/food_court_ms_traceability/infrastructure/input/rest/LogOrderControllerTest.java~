package com.example.food_court_ms_traceability.infrastructure.input.rest;

import com.example.food_court_ms_traceability.application.dto.request.LogOrderRequest;
import com.example.food_court_ms_traceability.application.handler.ILogOrderHandler;
import com.example.food_court_ms_traceability.infrastructure.util.RoleConstants;
import org.junit.jupiter.api.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.context.SecurityContextHolder;

import java.util.Collections;

import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;
import static org.mockito.Mockito.*;

@SpringBootTest
public class LogOrderControllerTest {

    @Mock
    private ILogOrderHandler logOrderHandler;

    @InjectMocks
    private LogOrderController controller;

    @Test
    public void test_customer_can_register_valid_order_status_change() {
        // Arrange
        LogOrderRequest request = new LogOrderRequest("order123", "customer456", "PENDING");

        // Act & Assert
        assertDoesNotThrow(() -> controller.registerChangeState(request));

        verify(logOrderHandler).registerChangeState(request);
    }
}
